{"pages":[],"posts":[{"title":"Pyspark dataframe을 Transpose 해서 ColumnSimilarities 구하기 part 1","text":"ColumnSimilarities를 구할때 데이터 프레임을 전치 시켜야 할 경우아래와 같은 방법으로 진행합니다. 1) dataframe 생성 12rdd = sc.parallelize([(1,2,3),(4,5,6),(7,8,9)])df = rdd.toDF([&quot;a&quot;,&quot;b&quot;,&quot;c&quot;]) a b c 1 2 3 4 5 6 7 8 9 2) row를 vector로 변경 12345vector_new = VectorAssembler() \\ .setInputCols([&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]) \\ .setOutputCol(&quot;vectors&quot;) vector_df = vector_new.transform(df) a b c vectors 1 2 3 [1.0,2.0,3.0] 4 5 6 [4.0,5.0,6.0] 7 8 9 [7.0,8.0,9.0] 3) IndexedRowMatrix 생성하기 위한 index 생성 1vector_df = vector_df.withColumn(&quot;index&quot;, monotonically_increasing_id()).select('index','vectors') id vectors 42949672960 [1.0,2.0,3.0] 85899345920 [4.0,5.0,6.0] 128849018880 [7.0,8.0,9.0] 4) Transpose(IndexedRowMatrix -&gt; toBlockMatrix -&gt; transpose -&gt;) 1234transpose_matrix = IndexedRowMatrix(vector_df.rdd.map(lambda x : (x.id, x.vector.toArray()))) .toBlockMatrix() .transpose() .toIndexedRowMatrix() 5) columnSimilarities 1transpose_matrix.columnSimilarities() 하지만 에러가 발생한다 java.lang.IllegalArgumentException: requirement failed: Vectors must be the same length! 백터의 길이가 다르다니 이 무슨 개소리인가… 3개로 똑같은데다음편에 계속","link":"/2020/04/24/first/"},{"title":"Hello World","text":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new \"My New Post\" More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment","link":"/2020/04/17/hello-world/"}],"tags":[{"name":"pyspark","slug":"pyspark","link":"/tags/pyspark/"}],"categories":[]}